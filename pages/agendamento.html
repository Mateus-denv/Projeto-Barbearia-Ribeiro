<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P√°gina Incial</title>
    <link rel="stylesheet" href="/assets/css/base/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1> MARIO BARBER </h1>
        </header>

        <div class="booking-section">
            <h2 style="color: #d4af37; margin-bottom: 30px; text-align: center; font-size: 2rem;">Agendar Hor√°rio</h2>
            
            <form id="bookingForm" class="form-grid">
                <div class="form-left">
                    <div class="form-group">
                        <label for="clientName">Nome Completo</label>
                        <input type="text" id="clientName" name="clientName" required placeholder="Digite seu nome completo">
                    </div>
                    
                    <div class="form-group">
                        <label for="clientPhone">Telefone</label>
                        <input type="tel" id="clientPhone" name="clientPhone" required placeholder="(11) 99999-9999">
                    </div>
                    
                    <div class="form-group">
                        <label for="appointmentDate">Data do Agendamento</label>
                        <input type="date" id="appointmentDate" name="appointmentDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="barber">Barbeiro (Opcional)</label>
                        <select id="barber" name="barber">
                            <option value="">Sem prefer√™ncia</option>
                            <option value="joao">Jo√£o Silva</option>
                            <option value="pedro">Pedro Santos</option>
                            <option value="carlos">Carlos Oliveira</option>
                            <option value="marcos">Marcos Costa</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="observations">Observa√ß√µes</label>
                        <textarea id="observations" name="observations" rows="3" placeholder="Alguma observa√ß√£o especial?"></textarea>
                    </div>
                </div>

                <div class="form-right">
                    <div class="form-group">
                        <label>Selecione os Servi√ßos</label>
                        <div class="services-grid">
                            <div class="service-card" data-service="corte" data-price="25">
                                <h3>‚úÇÔ∏è Corte Masculino</h3>
                                <p>Corte moderno e personalizado</p>
                                <div class="service-price">R$ 25,00</div>
                            </div>
                            
                            <div class="service-card" data-service="barba" data-price="20">
                                <h3>ü™í Barba</h3>
                                <p>Barba alinhada e bem feita</p>
                                <div class="service-price">R$ 20,00</div>
                            </div>
                            
                            <div class="service-card" data-service="combo" data-price="40">
                                <h3>üíé Combo Completo</h3>
                                <p>Corte + Barba + Acabamento</p>
                                <div class="service-price">R$ 40,00</div>
                            </div>
                            
                            <div class="service-card" data-service="sobrancelha" data-price="15">
                                <h3>üëÅÔ∏è Sobrancelha</h3>
                                <p>Design e alinhamento</p>
                                <div class="service-price">R$ 15,00</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Hor√°rios Dispon√≠veis</label>
                        <div class="time-slots" id="timeSlots">
                            <div class="time-slot" data-time="09:00">09:00</div>
                            <div class="time-slot" data-time="09:30">09:30</div>
                            <div class="time-slot" data-time="10:00">10:00</div>
                            <div class="time-slot" data-time="10:30">10:30</div>
                            <div class="time-slot" data-time="11:00">11:00</div>
                            <div class="time-slot" data-time="11:30">11:30</div>
                            <div class="time-slot" data-time="14:00">14:00</div>
                            <div class="time-slot" data-time="14:30">14:30</div>
                            <div class="time-slot" data-time="15:00">15:00</div>
                            <div class="time-slot" data-time="15:30">15:30</div>
                            <div class="time-slot" data-time="16:00">16:00</div>
                            <div class="time-slot" data-time="16:30">16:30</div>
                            <div class="time-slot" data-time="17:00">17:00</div>
                            <div class="time-slot" data-time="17:30">17:30</div>
                            <div class="time-slot" data-time="18:00">18:00</div>
                        </div>
                    </div>
                    
                    <div id="totalPrice" style="text-align: center; font-size: 1.5rem; color: #d4af37; margin: 20px 0; font-weight: bold;">
                        Total: R$ 0,00
                    </div>
                    
                    <button type="submit" class="btn">Confirmar Agendamento</button>
                </div>
            </form>
        </div>

        <div class="booking-section">
            <h2 style="color: #d4af37; margin-bottom: 30px; text-align: center; font-size: 2rem;">Seus Agendamentos</h2>
            
            <div class="appointments-list" id="appointmentsList">
                <!-- Exemplo de agendamentos -->
                <div class="appointment-item">
                    <div class="appointment-info">
                        <h4>Combo Completo</h4>
                        <p><strong>Data:</strong> 15/03/2024 √†s 14:30</p>
                        <p><strong>Barbeiro:</strong> Jo√£o Silva</p>
                        <p><strong>Valor:</strong> R$ 40,00</p>
                    </div>
                    <button class="btn-cancel" onclick="cancelAppointment(1)">Cancelar</button>
                </div>
                
                <div class="appointment-item">
                    <div class="appointment-info">
                        <h4>Corte Masculino</h4>
                        <p><strong>Data:</strong> 20/03/2024 √†s 10:00</p>
                        <p><strong>Barbeiro:</strong> Pedro Santos</p>
                        <p><strong>Valor:</strong> R$ 25,00</p>
                    </div>
                    <button class="btn-cancel" onclick="cancelAppointment(2)">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Vari√°veis globais
        let selectedServices = [];
        let selectedTime = null;
        let totalPrice = 0;

        // Definir data m√≠nima como hoje
        document.getElementById('appointmentDate').min = new Date().toISOString().split('T')[0];

        // Sele√ß√£o de servi√ßos
        document.querySelectorAll('.service-card').forEach(card => {
            card.addEventListener('click', function() {
                const service = this.dataset.service;
                const price = parseInt(this.dataset.price);
                
                if (this.classList.contains('selected')) {
                    // Remover servi√ßo
                    this.classList.remove('selected');
                    selectedServices = selectedServices.filter(s => s.service !== service);
                    totalPrice -= price;
                } else {
                    // Adicionar servi√ßo
                    this.classList.add('selected');
                    selectedServices.push({ service, price });
                    totalPrice += price;
                }
                
                updateTotalPrice();
            });
        });

        // Sele√ß√£o de hor√°rio
        document.querySelectorAll('.time-slot').forEach(slot => {
            slot.addEventListener('click', function() {
                if (this.classList.contains('unavailable')) return;
                
                // Remove sele√ß√£o anterior
                document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
                
                // Adiciona nova sele√ß√£o
                this.classList.add('selected');
                selectedTime = this.dataset.time;
            });
        });

        // Atualizar pre√ßo total
        function updateTotalPrice() {
            document.getElementById('totalPrice').textContent = `Total: R$ ${totalPrice.toFixed(2).replace('.', ',')}`;
        }

        // Simular hor√°rios ocupados baseado na data
        document.getElementById('appointmentDate').addEventListener('change', function() {
            const selectedDate = new Date(this.value);
            const dayOfWeek = selectedDate.getDay();
            
            // Reset all time slots
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('unavailable');
            });
            
            // Simular alguns hor√°rios ocupados
            const occupiedSlots = ['10:30', '15:00', '16:30'];
            occupiedSlots.forEach(time => {
                const slot = document.querySelector(`[data-time="${time}"]`);
                if (slot && Math.random() > 0.5) { // 50% de chance de estar ocupado
                    slot.classList.add('unavailable');
                }
            });
        });

        // Formata√ß√£o do telefone
        document.getElementById('clientPhone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/^(\d{2})(\d)/g, '($1) $2');
            value = value.replace(/(\d)(\d{4})$/, '$1-$2');
            e.target.value = value;
        });

        // Envio do formul√°rio
        document.getElementById('bookingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Valida√ß√µes
            if (selectedServices.length === 0) {
                showNotification('Por favor, selecione pelo menos um servi√ßo!', 'error');
                return;
            }
            
            if (!selectedTime) {
                showNotification('Por favor, selecione um hor√°rio!', 'error');
                return;
            }
            
            // Simular envio para o servidor
            const formData = new FormData(this);
            const appointmentData = {
                clientName: formData.get('clientName'),
                clientPhone: formData.get('clientPhone'),
                clientEmail: formData.get('clientEmail'),
                appointmentDate: formData.get('appointmentDate'),
                appointmentTime: selectedTime,
                barber: formData.get('barber'),
                services: selectedServices,
                observations: formData.get('observations'),
                totalPrice: totalPrice
            };
            
            console.log('Dados do agendamento:', appointmentData);
            
            // Aqui voc√™ enviaria os dados para o servidor
            // fetch('/api/appointments', { method: 'POST', body: JSON.stringify(appointmentData) })
            
            showNotification('Agendamento realizado com sucesso!', 'success');
            
            // Reset do formul√°rio
            this.reset();
            selectedServices = [];
            selectedTime = null;
            totalPrice = 0;
            updateTotalPrice();
            document.querySelectorAll('.service-card, .time-slot').forEach(el => el.classList.remove('selected'));
        });

        // Fun√ß√£o para mostrar notifica√ß√µes
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification show';
            
            if (type === 'error') {
                notification.style.background = 'linear-gradient(45deg, #e74c3c, #c0392b)';
            } else {
                notification.style.background = 'linear-gradient(45deg, #27ae60, #2ecc71)';
            }
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Fun√ß√£o para cancelar agendamento
        function cancelAppointment(id) {
            if (confirm('Tem certeza que deseja cancelar este agendamento?')) {
                // Aqui voc√™ faria a requisi√ß√£o para cancelar no servidor
                // fetch(`/api/appointments/${id}`, { method: 'DELETE' })
                
                showNotification('Agendamento cancelado com sucesso!', 'success');
                
                // Remove o item da lista (simula√ß√£o)
                event.target.closest('.appointment-item').style.opacity = '0.5';
                setTimeout(() => {
                    event.target.closest('.appointment-item').remove();
                }, 300);
            }
        }
    </script>
</body>
</html>